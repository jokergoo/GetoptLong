<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simple variable interpolation â€¢ GetoptLong</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simple variable interpolation">
<meta property="og:description" content="GetoptLong">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GetoptLong</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/GetoptLong.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/variable_interpolation.html">Simple variable interpolation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/GetoptLong/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="variable_interpolation_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simple variable interpolation</h1>
                        <h4 class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 class="date">2021-07-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/GetoptLong/blob/master/vignettes/variable_interpolation.Rmd"><code>vignettes/variable_interpolation.Rmd</code></a></small>
      <div class="hidden name"><code>variable_interpolation.Rmd</code></div>

    </div>

    
    
<hr>
<p>There are several ways to construct strings in <strong>R</strong> such as <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code>. However, when the string which is going to be constructed is too complex, using <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> can be a pain. For example, we want to put some parameters as title in a plot.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">region</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">value</span> <span class="op">=</span> <span class="fl">4</span>
<span class="va">name</span> <span class="op">=</span> <span class="st">"name"</span>
<span class="va">str</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"region = ("</span>, <span class="va">region</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">", "</span>, <span class="va">region</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"), value = "</span>, <span class="va">value</span>, 
            <span class="st">", name = '"</span>, <span class="va">name</span>, <span class="st">"'"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span></code></pre></div>
<pre><code>## region = (1, 2), value = 4, name = 'name'</code></pre>
<p>As you can see, it is hard to read and very easy to make mistakes. (Syntax highlighting may be helpful to match brackets, but it is still quite annoying to see so many commas and quotes.)</p>
<p>In <strong>Perl</strong>, we always use variable interpolation to construct complex strings in which variables are started with special marks (sigil), and variables will be replaced with their real values. In this package, we aim to implement variable interpolation in R. The idea is rather simple: use special marks to identify variables and then replace with their values. The function here is <code><a href="../reference/qq.html">qq()</a></code> which is named from the subroutine with the same name in <strong>Perl</strong> (It stands for double quote). Using variable interpolation, above example can be written as:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/GetoptLong">GetoptLong</a></span><span class="op">)</span>

<span class="va">str</span> <span class="op">=</span> <span class="fu"><a href="../reference/qq.html">qq</a></span><span class="op">(</span><span class="st">"region = (@{region[1]}, @{region[2]}), value = @{value}, name = '@{name}'"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span></code></pre></div>
<pre><code>## region = (1, 2), value = 4, name = 'name'</code></pre>
<p>Or use the shortcut function <code><a href="../reference/qqcat.html">qqcat()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"region = (@{region[1]}, @{region[2]}), value = @{value}, name = '@{name}'"</span><span class="op">)</span></code></pre></div>
<pre><code>## region = (1, 2), value = 4, name = 'name'</code></pre>
<p>One feature of <code><a href="../reference/qqcat.html">qqcat()</a></code> is you can set a global prefix to the messages by <code><a href="../reference/qq.options.html">qq.options("cat_prefix")</a></code>, either a string or a function. If it is set as a function, the value will be generated at real time by executing the function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span><span class="st">"cat_prefix"</span> <span class="op">=</span> <span class="st">"[INFO] "</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is a message"</span><span class="op">)</span></code></pre></div>
<pre><code>## [INFO] This is a message</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span><span class="st">"cat_prefix"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"[%Y-%m-%d %H:%M:%S] "</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is a message"</span><span class="op">)</span></code></pre></div>
<pre><code>## [2021-07-01 14:46:23] This is a message</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is a message after 2 seconds"</span><span class="op">)</span></code></pre></div>
<pre><code>## [2021-07-01 14:46:25] This is a message after 2 seconds</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span><span class="st">"cat_prefix"</span> <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is a message"</span><span class="op">)</span></code></pre></div>
<pre><code>## This is a message</code></pre>
<p>You can shut down all messages produced by <code><a href="../reference/qqcat.html">qqcat()</a></code> by <code><a href="../reference/qq.options.html">qq.options("cat_verbose" = FALSE)</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span><span class="st">"cat_prefix"</span> <span class="op">=</span> <span class="st">"[INFO] "</span>, <span class="st">"cat_verbose"</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is a message"</span><span class="op">)</span></code></pre></div>
<p>Also you can set a prefix which has local effect.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span>RESET <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span><span class="st">"cat_prefix"</span> <span class="op">=</span> <span class="st">"[DEBUG] "</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is a message"</span>, cat_prefix <span class="op">=</span> <span class="st">"[INFO] "</span><span class="op">)</span></code></pre></div>
<pre><code>## [INFO] This is a message</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is a message"</span><span class="op">)</span></code></pre></div>
<pre><code>## [DEBUG] This is a message</code></pre>
<p>From version 1.1.2, <code><a href="../reference/qq.options.html">qq.options()</a></code> can work in a local mode in which the copy of the options only work in a local chunk.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span><span class="st">"cat_prefix"</span> <span class="op">=</span> <span class="st">"[DEBUG] "</span><span class="op">)</span>
<span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span>LOCAL <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span><span class="st">"cat_prefix"</span> <span class="op">=</span> <span class="st">"[INFO] "</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is the first message"</span><span class="op">)</span></code></pre></div>
<pre><code>## [INFO] This is the first message</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is the second message"</span><span class="op">)</span></code></pre></div>
<pre><code>## [INFO] This is the second message</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span>LOCAL <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"This is the third message"</span><span class="op">)</span></code></pre></div>
<pre><code>## [DEBUG] This is the third message</code></pre>
<p>Reset the options so that it does not affect example code in following part of the vignette.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span>RESET <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Not only simple scalars but also pieces of codes can be interpolated:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fl">1</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"There @{ifelse(n == 1, 'is', 'are')} @{n} dog@{ifelse(n == 1, '', 's')}.\n"</span><span class="op">)</span></code></pre></div>
<pre><code>## There is 1 dog.</code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fl">2</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"There @{ifelse(n == 1, 'is', 'are')} @{n} dog@{ifelse(n == 1, '', 's')}.\n"</span><span class="op">)</span></code></pre></div>
<pre><code>## There are 2 dogs.</code></pre>
<p>If the text is too long, it can be wrapped into lines.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span><span class="st">"cat_strwrap"</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty."</span><span class="op">)</span></code></pre></div>
<pre><code>## one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen,
## fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty.</code></pre>
<p>There can be multiple templates:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">=</span> <span class="fl">1</span>; <span class="va">b</span> <span class="op">=</span> <span class="fl">2</span>; <span class="va">c</span> <span class="op">=</span> <span class="fl">3</span>
<span class="va">txt</span> <span class="op">=</span> <span class="fu"><a href="../reference/qq.html">qq</a></span><span class="op">(</span><span class="st">"command -a @{a}"</span>,
         <span class="st">"        -b @{b}"</span>,
         <span class="st">"        -c @{c}\n"</span>, sep <span class="op">=</span> <span class="st">" \\\n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">txt</span><span class="op">)</span></code></pre></div>
<pre><code>## command -a 1 \
##         -b 2 \
##         -c 3</code></pre>
<p><strong>NOTE:</strong> Since <code>qq</code> as the function name is very easy to be used by other packages (E.g., in <strong>lattice</strong>, there is a <code><a href="../reference/qq.html">qq()</a></code> function as well) and if so, you can enforce <code><a href="../reference/qq.html">qq()</a></code> in your working environment as the function in <strong>GetoptLong</strong> by:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qq</span> <span class="op">=</span> <span class="fu">GetoptLong</span><span class="fu">::</span><span class="va"><a href="../reference/qq.html">qq</a></span></code></pre></div>
<div id="code-patterns" class="section level2">
<h2 class="hasAnchor">
<a href="#code-patterns" class="anchor"></a>Code patterns</h2>
<p>In above exmaple, <code>@{}</code> is used to mark variables. Later, variable names will be extracted from these marks and replaced with their real values.</p>
<p>The marking code pattern can be any type. But you should make sure it is easy to tell the difference from other part in the string. You can set your code pattern as an argument in <code><a href="../reference/qq.html">qq()</a></code>. The default pattern is <code>@\\{CODE\\}</code> because we only permit <code>CODE</code> to return simple vectors and <code><a href="https://rdrr.io/r/base/slotOp.html">@</a></code> is a sigil representing array in <strong>Perl</strong>.</p>
<p>In following example, the code pattern is <code>#{}</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"x = #{x}"</span>, code.pattern <span class="op">=</span> <span class="st">"#\\{CODE\\}"</span><span class="op">)</span></code></pre></div>
<pre><code>## x = 1</code></pre>
<p>Or set in <code><a href="../reference/qq.options.html">qq.options()</a></code> as a global setting:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qq.options.html">qq.options</a></span><span class="op">(</span><span class="st">"code.pattern"</span> <span class="op">=</span> <span class="st">"#\\{CODE\\}"</span><span class="op">)</span></code></pre></div>
<p>As you can guess, in <code>@\\{CODE\\}</code>, <code>CODE</code> will be replaced with <code>.*?</code> to construct a regular expression and to match variable names in the string. So if your <code>code.pattern</code> contains special characters, make sure to escape them. Some candidate <code>code.pattern</code> are:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"@\\{CODE\\}"</span>    <span class="co"># default style</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"@\\[CODE\\]"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"@\\(CODE\\)"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"%\\{CODE\\}"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"%\\[CODE\\]"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"%\\(CODE\\)"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"\\$\\{CODE\\}"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"\\$\\[CODE\\]"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"\\$\\(CODE\\)"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"#\\{CODE\\}"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"#\\[CODE\\]"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"#\\(CODE\\)"</span>
<span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"\\[%CODE%\\]"</span>  <span class="co"># Template Toolkit (Perl module) style :)</span></code></pre></div>
<p>Since we just replace <code>CODE</code> to <code>.*?</code>, the function will only match to the first right parentheses/brackets. (In <strong>Perl</strong>, I always use recursive regular expression to extract such pairing parentheses. But in <strong>R</strong>, it seems difficult.) So, for example, if you are using <code>@\\[CODE\\]</code> and your string is <code>"@[a[1]]"</code>, it will fail to extract the correct variable name while only extracts <code>a[1</code>, finally it generates an error when executing <code>a[1</code>. In such condition, you should use other pattern styles that do not contain <code>[]</code>.</p>
<p>Finally, I suggest a more safe code pattern style that you do not need to worry about parentheses stuff:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">code.pattern</span> <span class="op">=</span> <span class="st">"`CODE`"</span></code></pre></div>
</div>
<div id="where-to-look-for-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#where-to-look-for-variables" class="anchor"></a>Where to look for variables</h2>
<p>It will first look up in the envoking environment, then through searching path. Users can also pass values of variables as a list like:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">y</span> <span class="op">=</span> <span class="fl">2</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"x = @{x}, y = @{y}"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"a"</span>, y <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## x = a, y = b</code></pre>
<p>If variables are passed through list, <code><a href="../reference/qq.html">qq()</a></code> only looks up in the specified list.</p>
</div>
<div id="variables-should-only-return-vectors" class="section level2">
<h2 class="hasAnchor">
<a href="#variables-should-only-return-vectors" class="anchor"></a>Variables should only return vectors</h2>
<p><code><a href="../reference/qq.html">qq()</a></code> only allows variables to return vectors. The whole string will be interpolated repeatedly according to longest vectors, and finally concatenated into a single long string.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"@{x} is an @{ifelse(x %% 2, 'odd', 'even')} number.\n"</span><span class="op">)</span></code></pre></div>
<pre><code>## 1 is an odd number. 2 is an even number. 3 is an odd number. 4 is an even number. 5 is an
## odd number. 6 is an even number.</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>
<span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span><span class="op">)</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"@{x}, @{y}, @{z}\n"</span><span class="op">)</span></code></pre></div>
<pre><code>## 1, a, A 2, b, B 3, a, C 4, b, D 5, a, E 6, b, A</code></pre>
<p>This feature is especially useful if you want to generate a report such as formatted in a HTML table:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">name</span> <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="va">value</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>
<span class="fu"><a href="../reference/qqcat.html">qqcat</a></span><span class="op">(</span><span class="st">"&lt;tr&gt;&lt;td&gt;@{name}&lt;/td&gt;&lt;td&gt;@{value}&lt;/td&gt;&lt;tr&gt;\n"</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;tr&gt; &lt;tr&gt;&lt;td&gt;b&lt;/td&gt;&lt;td&gt;2&lt;/td&gt;&lt;tr&gt; &lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;3&lt;/td&gt;&lt;tr&gt;
## &lt;tr&gt;&lt;td&gt;d&lt;/td&gt;&lt;td&gt;4&lt;/td&gt;&lt;tr&gt;</code></pre>
<p>The returned value can also be a vector while not collapsed into one string:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">str</span> <span class="op">=</span> <span class="fu"><a href="../reference/qq.html">qq</a></span><span class="op">(</span><span class="st">"@{x}, @{y}, @{z}"</span>, collapse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">str</span></code></pre></div>
<pre><code>## [1] "1, a, A" "2, b, B" "3, a, C" "4, b, D" "5, a, E" "6, b, A"</code></pre>
</div>
<div id="session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h2>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] C/UTF-8/C/C/C/C
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] GetoptLong_1.0.3 knitr_1.33       markdown_1.1    
## 
## loaded via a namespace (and not attached):
##  [1] magrittr_2.0.1      rjson_0.2.20        R6_2.5.0            ragg_1.1.3         
##  [5] rlang_0.4.11        fastmap_1.1.0       stringr_1.4.0       tools_4.1.0        
##  [9] xfun_0.24           jquerylib_0.1.4     htmltools_0.5.1.1   systemfonts_1.0.2  
## [13] yaml_2.2.1          digest_0.6.27       rprojroot_2.0.2     pkgdown_1.6.1      
## [17] crayon_1.4.1        textshaping_0.3.5   GlobalOptions_0.1.2 sass_0.4.0         
## [21] fs_1.5.0            memoise_2.0.0       cachem_1.0.5        evaluate_0.14      
## [25] rmarkdown_2.9       stringi_1.6.2       compiler_4.1.0      bslib_0.2.5.1      
## [29] desc_1.3.0          jsonlite_1.7.2</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
